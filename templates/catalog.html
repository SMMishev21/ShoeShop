{% extends "base.html" %}
{% block content %}
<form method="get" action="{{ url_for('catalog.catalog') }}" class="filter-form">
    <h2>üîç –ö–∞—Ç–∞–ª–æ–≥</h2>
    <input type="text" name="q" placeholder="üîé –¢—ä—Ä—Å–µ–Ω–µ (–∏–º–µ –∏–ª–∏ —Ü–≤—è—Ç)" value="{{ request.args.get('q','') }}">
    <input type="text" name="color" placeholder="üé® –¶–≤—è—Ç" value="{{ request.args.get('color','') }}">
    <input type="text" name="size" placeholder="üìè –†–∞–∑–º–µ—Ä (–Ω–∞–ø—Ä. 42)" value="{{ request.args.get('size','') }}">
    <input type="number" name="price_min" placeholder="üí∞ –ú–∏–Ω. —Ü–µ–Ω–∞" value="{{ request.args.get('price_min','') }}" step="0.01">
    <input type="number" name="price_max" placeholder="üí∞ –ú–∞–∫—Å. —Ü–µ–Ω–∞" value="{{ request.args.get('price_max','') }}" step="0.01">
    <button type="submit">–§–∏–ª—Ç—Ä–∏—Ä–∞–π</button>
</form>

<div class="products">
{% for p in products %}
    <div class="product">
        <img src="{{ p.image_url }}" alt="{{ p.name }}" onerror="this.src='https://images.unsplash.com/photo-1460353581641-37baddab0fa2?auto=format&fit=crop&w=400&q=80'">
        <div class="product-content">
            <h3>{{ p.name }}</h3>
            <p class="price">{{ "%.2f"|format(p.price) }} –ª–≤</p>
            <p>{{ p.description }}</p>
            <p><strong>–¶–≤—è—Ç:</strong> {{ p.color }}</p>
            <p><strong>–†–∞–∑–º–µ—Ä–∏:</strong> {{ p.sizes|join(', ') }}</p>
            <p><strong>–ù–∞–ª–∏—á–Ω–æ—Å—Ç:</strong> {{ p.stock }} –±—Ä.</p>
            <form method="post" action="{{ url_for('cart.add_to_cart', product_id=p.id) }}">
                <input type="number" name="qty" value="1" min="1" max="{{ p.stock }}">
                <button type="submit">üõí –î–æ–±–∞–≤–∏</button>
            </form>
        </div>
    </div>
{% else %}
    <div style="grid-column: 1/-1; text-align: center; padding: 60px 20px;">
        <h3 style="color: #7f8c8d; font-size: 1.5rem;">üòï –ù—è–º–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏ –ø—Ä–æ–¥—É–∫—Ç–∏</h3>
        <p style="color: #95a5a6;">–û–ø–∏—Ç–∞–π—Ç–µ —Å –¥—Ä—É–≥–∏ —Ñ–∏–ª—Ç—Ä–∏ –∑–∞ —Ç—ä—Ä—Å–µ–Ω–µ</p>
    </div>
{% endfor %}
</div>

{% endblock %}